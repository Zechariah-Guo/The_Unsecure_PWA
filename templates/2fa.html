{% extends 'layout.html' %}
{% block content %}
<h1 class="text-center">Enable Two-Factor Authentication</h1>
<p>Welcome {{ value }}. Scan the QR code with your authenticator app.</p>
<div class="qr-container">
  {{ qr_code_svg|safe }}
</div>
<p>Once scanned, enter the 6-digit code from your app below:</p>
<form action="/2fa/setup" method="post" class="box">
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
  <div class="input__wrapper">
    <input
      type="text"
      name="otp"
      id="otp"
      placeholder="123456"
      class="input__field"
      minlength="6"
      maxlength="6"
      pattern="\d{6}"
      autocomplete="one-time-code"
      required
    />
  </div>
  <div class="input__wrapper">
    <input type="submit" class="btn" value="Verify" />
  </div>
</form>
<details>
  <summary class="manual-setup-summary">Can't scan? Manual setup</summary>
  <div class="manual-setup-content">
    <p><strong>Manual Setup Instructions:</strong></p>
    <ol class="manual-setup-list">
      <li>Open your authenticator app</li>
      <li>Select "Add account" or "+"</li>
      <li>Choose "Enter a setup key"</li>
      <li>Account: <strong>Unsecure PWA ({{ value }})</strong></li>
      <li>Key: <code class="manual-setup-code">{{ secret }}</code></li>
      <li>Type: Time-based</li>
    </ol>
  </div>
</details>
{% if msg %}
<div>{{ msg }}</div>
{% endif %}
{% endblock %}
