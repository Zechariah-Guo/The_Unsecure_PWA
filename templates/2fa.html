{% extends 'layout.html' %}
{% block content %}
<h1>Enable Two-Factor Authentication</h1>
<p>Welcome {{ value }}. Scan the QR code in your authenticator app and enter the 6-digit code.</p>
<img src="data:image/png;base64,{{ qr_code }}" alt="2FA QR code" />
<form action="/2fa" method="post" class="box">
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
  <div class="input__wrapper">
    <input
      type="text"
      name="otp"
      id="otp"
      placeholder="123456"
      class="input__field"
      minlength="6"
      maxlength="6"
      pattern="\d{6}"
      autocomplete="one-time-code"
      required
    />
  </div>
  <div class="input__wrapper">
    <input type="submit" class="btn" value="Verify" />
  </div>
</form>
{% if msg %}
<div>{{ msg }}</div>
{% endif %}
{% endblock %}
